const isOpenClass="modal-is-open",openingClass="modal-is-opening",closingClass="modal-is-closing",DEFAULT_ANIMATION_DURATION=400;let visibleModal=null,_scrollbarWidthCache=null,_openTimer=null,_closeTimer=null;const getAnimationDuration=()=>{try{return window.matchMedia&&window.matchMedia("(prefers-reduced-motion: reduce)").matches?0:400}catch(e){return 400}},toggleModal=e=>{if(!e||!e.currentTarget)return;e.preventDefault();const t=e.currentTarget.getAttribute&&e.currentTarget.getAttribute("data-target");if(!t)return;const n=document.getElementById(t);n&&(isModalOpen(n)?closeModal(n):openModal(n))},isModalOpen=e=>!(!e||"function"!=typeof e.hasAttribute)&&(e.hasAttribute("open")&&"false"!==e.getAttribute("open")),openModal=e=>{if(!e)return;if(_closeTimer&&(clearTimeout(_closeTimer),_closeTimer=null),isScrollbarVisible()){const e=getScrollbarWidth();e>0&&document.documentElement.style.setProperty("--scrollbar-width",`${e}px`)}const t=getAnimationDuration();document.documentElement.classList.add(isOpenClass,openingClass);try{e.setAttribute("open",!0)}catch(e){}_openTimer&&clearTimeout(_openTimer),_openTimer=setTimeout((()=>{visibleModal=e,document.documentElement.classList.remove(openingClass),_openTimer=null}),t)},closeModal=e=>{if(!e)return;_openTimer&&(clearTimeout(_openTimer),_openTimer=null),visibleModal=null,document.documentElement.classList.add(closingClass);const t=getAnimationDuration();_closeTimer&&clearTimeout(_closeTimer),_closeTimer=setTimeout((()=>{document.documentElement.classList.remove(closingClass,isOpenClass);try{document.documentElement.style.removeProperty("--scrollbar-width")}catch(e){}try{e.removeAttribute("open")}catch(e){}_closeTimer=null}),t)};document.addEventListener("click",(e=>{if(!visibleModal)return;if(!e||e.defaultPrevented)return;const t=visibleModal.querySelector&&visibleModal.querySelector("article");!!t&&t.contains(e.target)||closeModal(visibleModal)}),{passive:!0}),document.addEventListener("keydown",(e=>{e&&("Escape"!==e.key&&"Esc"!==e.key||!visibleModal||closeModal(visibleModal))}));const getScrollbarWidth=()=>{if(null!==_scrollbarWidthCache)return _scrollbarWidthCache;try{const e=document.createElement("div");e.style.visibility="hidden",e.style.overflow="scroll",e.style.msOverflowStyle="scrollbar",e.style.position="absolute",e.style.top="-9999px",document.body.appendChild(e);const t=document.createElement("div");e.appendChild(t);const n=e.offsetWidth-t.offsetWidth;return e.parentNode.removeChild(e),_scrollbarWidthCache="number"==typeof n?n:0,_scrollbarWidthCache}catch(e){return 0}},isScrollbarVisible=()=>{try{return document.documentElement&&document.documentElement.scrollHeight>window.innerHeight}catch(e){return!1}};function checkURL(e){if(!e)return e;var t="object"==typeof e&&"value"in e,n=String(t?e.value||"":e);return n&&-1===n.indexOf("://")&&(n="https://"+n),t&&(e.value=n),t?e:n}function changeData(e,t,n,o){var r;(r=document.getElementById("id"))&&(r.value=e||""),(r=document.getElementById("title"))&&(r.value=t||""),(r=document.getElementById("link"))&&(r.value=n||""),(r=document.getElementById("tags"))&&(r.value=o||"")}function randomBgColor(){var e=["#ADD8E6","#F08080","#E0FFFF","#FAFAD2","#D3D3D3","#90EE90","#FFB6C1","#FFA07A","#20B2AA","#87CEFA","#778899","#B0C4DE","#FFFFE0"];return e[Math.floor(Math.random()*e.length)]}function toggleTag(e){var t=String(e||"");Array.from(document.querySelectorAll("span.tag")).forEach((function(e){e.style.opacity="0.7",e.style.border="none",e.style.color="unset",e.setAttribute("aria-selected","false")}));var n=document.getElementById("bookmarks");if(n){if(localStorage.getItem("tag")===t)return Array.from(n.children).forEach((function(e){e.style.display="block"})),void localStorage.removeItem("tag");Array.from(n.children).forEach((function(e){if(e.style.display="none",String(e.getAttribute("data-tags")||"").indexOf(t)>-1){e.style.display="block";CSS.escape,CSS.escape(t);try{document.querySelectorAll("span[data-tag*='"+t+"']").forEach((function(e){e.style.color="var(--pico-primary)",e.style.opacity="1",e.setAttribute("aria-selected","true")}))}catch(e){}}})),localStorage.setItem("tag",t)}}function topTags(){var e=Array.from(document.querySelectorAll("span.tag")).map((function(e){return e.textContent||""})),t={};e.map((function(e){e in t?t[e]++:t[e]=1}));var n=Object.keys(t).sort((function(e,n){return t[e]-t[n]}));let o=5*Math.round(Math.sqrt(Object.keys(t).length)/5);o=o>10?10:o;var r=n.slice(Math.max(n.length-o,1));r=r.reverse();var a=document.getElementById("top-tags-placeholder");a&&r.forEach((function(e){var t=document.createElement("li"),n=document.createElement("span");n.classList.add("tag"),t.classList.add("top-tag"),n.dataset.tag=e,n.setAttribute("aria-controls",e),n.setAttribute("aria-selected","false"),n.setAttribute("tabindex","0"),n.addEventListener("click",(function(){toggleTag(e)})),n.addEventListener("keydown",(function(t){"Enter"!==t.key&&" "!==t.key||(t.preventDefault(),toggleTag(e))})),n.innerText=e,t.appendChild(n),a.before(t)}))}function generateBackgroundColors(){if("function"==typeof ColorThief){var e=new ColorThief;Array.from(document.querySelectorAll("div#bookmarks article")).forEach((function(t){try{var n=window.getComputedStyle(t),o=n&&n.backgroundImage?n.backgroundImage:"none";if("none"===o||!o||""===o)return void(t.style.background="linear-gradient(to bottom, white 0%,"+randomBgColor()+" 100%)");var r=o.match(/url\((?:\")?(.*?)(?:\")?\)/),a=r&&r[1]?r[1]:null;if(!a)return;var l=new Image;l.crossOrigin="anonymous",l.src=a,l.onload=function(){try{var n=e.getPalette(l,2)||[],o=n[1]||n[0]||[200,200,200];t.style.backgroundColor="rgba("+o[0]+","+o[1]+","+o[2]+",0.33)"}catch(e){}}}catch(e){}}))}}document.addEventListener("DOMContentLoaded",(function(){window.history.replaceState&&window.history.replaceState(null,null,window.location.href),function(){var e=document.getElementById("bookmarks");if(e){var t,n,o,r=Array.from(e.children||[]).map((function(e){return{card:e,text:(e.getAttribute("data-search")||"").toLowerCase()}})),a=(t=function(e){var t,n;t=e&&e.target?e.target.value:"",(n=String(t||"").toLowerCase())?r.forEach((function(e){e.card.style.display=e.text.indexOf(n)>-1?"block":"none"})):r.forEach((function(e){e.card.style.display="block"}))},n=120,o=null,function(){var e=arguments;clearTimeout(o),o=setTimeout((function(){t.apply(null,e)}),n)});Array.from(document.querySelectorAll("#s_title, #s_link, #s_tags")).forEach((function(e){e&&e.addEventListener("input",a,{passive:!0})}))}}()}),!1),document.addEventListener("DOMContentLoaded",(function(){var e;if("IntersectionObserver"in window){e=document.querySelectorAll(".lazy");var t=new IntersectionObserver((function(e,n){e.forEach((function(e){if(e.isIntersecting){var n=e.target;n.dataset&&n.dataset.src&&(n.src=n.dataset.src),n.classList.remove("lazy"),t.unobserve(n)}}))}));e.forEach((function(e){t.observe(e)}))}else{var n;function o(){n&&clearTimeout(n),n=setTimeout((function(){var t=window.pageYOffset||document.documentElement.scrollTop;0===(e=e.filter((function(e){return!(!e||e.classList.indexOf&&-1===e.classList.indexOf("lazy"))&&(!(e.getBoundingClientRect().top+t<window.innerHeight+t)||(e.dataset&&e.dataset.src&&(e.src=e.dataset.src),e.classList.remove("lazy"),!1))}))).length&&(document.removeEventListener("scroll",o),window.removeEventListener("resize",o),window.removeEventListener("orientationchange",o))}),100)}e=Array.from(document.querySelectorAll(".lazy")),document.addEventListener("scroll",o,{passive:!0}),window.addEventListener("resize",o,{passive:!0}),window.addEventListener("orientationchange",o,{passive:!0})}})),function(){const e="bookmark.cards.scrollY";window.addEventListener("beforeunload",(function(){try{sessionStorage.setItem(e,String(window.scrollY||0))}catch(e){}})),window.addEventListener("load",(function(){try{const t=sessionStorage.getItem(e);null!==t&&(window.scrollTo(0,parseInt(t,10)||0),sessionStorage.removeItem(e))}catch(e){}}))}();